<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ุญุงุณุจุฉ ุชูููู ูุฎุงุทุฑ ุงูุตูุงู</title>

  <style>
    :root{
      --bg:#f3efe8;            /* ุจูู ูุงุชุญ ุฌุฏูุง */
      --card:#ffffff;
      --text:#1f2d3d;
      --muted:#5b6772;
      --border:#e4dfd6;

      --ok:#1e8449; --mid:#7d6608; --hi:#922b21;
      --okbg:#eafaf1; --midbg:#fff8e1; --hibg:#fdecea;

      --btn:#6aaed6;            /* ุฃุฒุฑู ูุงุชุญ */
      --btn2:#b38b5d;           /* ุจูู ูุงุชุญ */
    }

    *{box-sizing:border-box}
    body{
      margin:0; background:var(--bg); color:var(--text);
      font-family:"Segoe UI",Tahoma,Arial,sans-serif; line-height:1.6;
    }
    .wrap{max-width:1020px;margin:0 auto;padding:18px;}
    .header{
      background:var(--card); border:1px solid var(--border);
      border-radius:18px; padding:18px; box-shadow:0 4px 12px rgba(0,0,0,.06);
      display:flex; gap:16px; align-items:center; flex-wrap:wrap;
      position:relative; overflow:hidden;
    }
    /* ููุณุฉ ุฑูุถุงููุฉ ุฑุณููุฉ (ุชุฏุฑุฌ ูุงุนู + ุฏูุงุฆุฑ) */
    .header::before{
      content:""; position:absolute; inset:-50px -50px auto -50px; height:150px;
      background:linear-gradient(90deg, rgba(179,139,93,.18), rgba(106,174,214,.18));
    }
    .header::after{
      content:""; position:absolute; left:20px; top:18px; width:120px; height:120px;
      border-radius:999px; border:2px solid rgba(106,174,214,.35);
      box-shadow:0 0 0 14px rgba(179,139,93,.12) inset;
    }
    .header > *{position:relative; z-index:1}

    .logo{
      width:92px;height:92px;border-radius:18px;object-fit:contain;
      border:1px solid var(--border);background:#fff;
    }
    h1{margin:0;font-size:1.35rem}
    .sub{margin:.4rem 0 0;color:var(--muted);font-size:.95rem}
    .pillrow{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
    .pill{
      font-size:.86rem;border:1px solid var(--border);
      padding:6px 10px;border-radius:999px;background:#faf7f2;color:#334;
    }

    .grid{display:grid;grid-template-columns:1fr;gap:14px;margin-top:14px;}
    @media (min-width: 920px){ .grid{grid-template-columns: 1.2fr .8fr;} }

    .card{
      background:var(--card);border:1px solid var(--border);
      border-radius:18px;padding:16px;box-shadow:0 4px 12px rgba(0,0,0,.05);
    }
    .card h2{margin:0 0 10px;font-size:1.12rem}

    .note{
      background:#fbfbfc;border:1px dashed var(--border);
      padding:10px 12px;border-radius:12px;color:var(--muted);font-size:.92rem;
    }

    details{
      border:1px solid var(--border);border-radius:14px;
      padding:10px 12px;background:#fff;margin:10px 0;
    }
    summary{cursor:pointer;font-weight:700;padding:4px 0;}
    summary small{font-weight:400;color:var(--muted)}

    .row{display:grid;grid-template-columns:1fr;gap:10px;margin-top:10px;}
    @media (min-width: 720px){ .row{grid-template-columns:1fr 1fr;} }

    label{display:block;font-weight:600;margin:8px 0 6px;}
    select,input[type="text"],input[type="number"],input[type="date"]{
      width:100%;padding:10px;border-radius:12px;border:1px solid var(--border);
      background:#fff;font-size:1rem;
    }

    .checks{display:grid;grid-template-columns:1fr;gap:8px;margin-top:10px;}
    @media (min-width: 720px){ .checks{grid-template-columns:1fr 1fr;} }

    .check{
      display:flex;gap:10px;align-items:flex-start;padding:10px;
      border:1px solid var(--border);border-radius:12px;background:#fcfdff;
    }
    .check input{margin-top:4px}
    .check b{display:block}
    .check span{display:block;color:var(--muted);font-size:.9rem}

    .actions{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px;}
    button{
      border:0;border-radius:12px;padding:11px 14px;cursor:pointer;font-size:1rem;
    }
    .primary{background:var(--btn);color:#fff;}
    .secondary{background:var(--btn2);color:#fff;}
    .ghost{background:#eef2f4;color:#233;border:1px solid var(--border);}

    .resultBox{margin-top:12px;border-radius:14px;padding:12px;border:1px solid var(--border);}
    .low{background:var(--okbg);color:var(--ok);}
    .med{background:var(--midbg);color:var(--mid);}
    .high{background:var(--hibg);color:var(--hi);}

    .bigScore{font-size:1.85rem;font-weight:800;margin:0}
    .small{color:var(--muted);margin:6px 0 0;font-size:.95rem}

    table{width:100%;border-collapse:collapse;margin-top:10px;}
    th,td{border-bottom:1px solid var(--border);text-align:right;padding:8px;font-size:.95rem;}
    th{background:#faf7f2}

    .qrArea{
      margin-top:14px;padding-top:12px;border-top:1px solid var(--border);
      display:grid;grid-template-columns:1fr;gap:12px;align-items:center;
    }
    @media (min-width: 720px){ .qrArea{grid-template-columns: 1fr auto;} }

    .qr{
      width:170px;height:170px;border:1px solid var(--border);
      border-radius:14px;background:#fff;padding:8px;
    }
    a{color:#0b62a4;text-decoration:none}
    a:hover{text-decoration:underline}

    footer{
      margin:18px 0 8px;text-align:center;color:var(--muted);font-size:.95rem;
    }
    .printHint{font-size:.9rem;color:var(--muted);margin-top:8px}

    @media print{
      body{background:#fff}
      .wrap{max-width:none;padding:0}
      .actions,.printHint{display:none !important}
      details{break-inside:avoid}
      .card,.header{box-shadow:none}
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="header">
      <!-- ุงุฑูุน ุงูุดุนุงุฑ ุฏุงุฎู ููุณ ุงููุณุชูุฏุน ุจุงุณู: logo.png -->
      <img class="logo" src="logo.png" alt="ุดุนุงุฑ ุงูุนูุงุฏุฉ" onerror="this.style.display='none';" />
      <div>
        <h1>ุญุงุณุจุฉ ุชูููู ูุฎุงุทุฑ ุงูุตูุงู ุนูู ุฃุนุฒุงุฆูุง ูุฑุถู ุงูุณูุฑู ูุจู ุฑูุถุงู</h1>
        <p class="sub">
          ุฃุฏุงุฉ ุชุซููููุฉ ูุจููุฉ ุนูู ุนูุงุตุฑ <b>DAR Risk Assessment Tool (2026)</b> ูุชูุฏูุฑ ูุณุชูู ูุฎุงุทุฑ ุงูุตูุงู.
          ูุง ุชุบูู ุนู ุงูุชูููู ุงูุทุจู ุงููุฑุฏู ููุง ุนู ูุฑุงุฑ ุงูุทุจูุจ ูุฎุทุฉ ุงูุนูุงุฌ ูุงููุชุงุจุนุฉ.
        </p>
        <div class="pillrow">
          <span class="pill">ูุณุฎุฉ ุนูุงุฏูุฉ</span>
          <span class="pill">ูุบุฉ ูุงุถุญุฉ ููุญุงูุฏุฉ</span>
          <span class="pill">ุนุฑุถ ุชูุงุตูู ุงูููุงุท + ุทุจุงุนุฉ</span>
        </div>
      </div>
    </div>

    <div class="grid">
      <!-- ูููุฐุฌ ุงูุชูููู -->
      <div class="card">
        <h2>ุนูุงุตุฑ ุงูุชูููู (DAR 2026)</h2>

        <div class="note">
          ุงููุฃ ุจูุงูุงุช ุงููุฑูุถ ุฃูููุงุ ุซู ุงุฎุชุฑ ุงูุฅุฌุงุจุฉ ุงูุฃูุณุจ ูู ูู ุจูุฏ.
          ูู ุจูุฏ <b>ููุน ุงูุนูุงุฌ</b> ููููู ุงุฎุชูุงุฑ ุฃูุซุฑ ูู ุฎูุงุฑ (ุงุฎุชุฑ ูู ูุง ููุทุจู).
          ูู ุงูููุงูุฉ ุงุถุบุท <b>ุงุญุณุจ ุงููุชูุฌุฉ</b> ูุนุฑุถ ูุฌููุน ุงูููุงุท ููุณุชูู ุงููุฎุงุทุฑ.
        </div>

        <!-- ุจูุงูุงุช ุงููุฑูุถ -->
        <details open>
          <summary>ุจูุงูุงุช ุงููุฑูุถ <small>(ุชุธูุฑ ุฃูุถูุง ุนูุฏ ุงูุทุจุงุนุฉ)</small></summary>
          <div class="row">
            <div>
              <label for="pname">ุงุณู ุงููุฑูุถ</label>
              <input id="pname" type="text" placeholder="ุงูุชุจ ุงุณู ุงููุฑูุถ (ุงุฎุชูุงุฑู)" />
            </div>
            <div>
              <label for="page">ุงูุนูุฑ</label>
              <input id="page" type="number" min="0" max="120" placeholder="ูุซุงู: 45" />
            </div>
          </div>
          <div class="row">
            <div>
              <label for="psex">ุงูุฌูุณ</label>
              <select id="psex">
                <option value="">ุงุฎุชุฑ</option>
                <option value="ุฐูุฑ">ุฐูุฑ</option>
                <option value="ุฃูุซู">ุฃูุซู</option>
              </select>
            </div>
            <div>
              <label for="pdate">ุชุงุฑูุฎ ุงูุชูููู</label>
              <input id="pdate" type="date" />
            </div>
          </div>
          <div class="note" style="margin-top:10px">
            ููุงุญุธุฉ ุฎุตูุตูุฉ: ุฅุฏุฎุงู ุงูุจูุงูุงุช ุงุฎุชูุงุฑู. ูุง ูุชู ุญูุธ ุฃู ูุนูููุงุช ุฃู ุฅุฑุณุงููุงุ ุงูุญุงุณุจุฉ ุชุนูู ุฏุงุฎู ุงููุชุตูุญ ููุท.
          </div>
        </details>

        <!-- 1) ุงูุญูู -->
        <details>
          <summary>1) ุงูุญูู ูุน ุฃู ููุน ูู ุงูุณูุฑู <small>(ุฅู ูุฌุฏ)</small></summary>
          <label for="preg">ูู ุชูุฌุฏ ุญุงูุฉ ุญููุ</label>
          <select id="preg">
            <option value="0">ูุง (0)</option>
            <option value="6.5">ูุนู (+6.5)</option>
          </select>
        </details>

        <!-- 2 + 3 -->
        <details>
          <summary>2) ููุน ุงูุณูุฑู + 3) ูุฏุฉ ุงูุฅุตุงุจุฉ</summary>
          <div class="row">
            <div>
              <label for="dtype">ููุน ุงูุณูุฑู</label>
              <select id="dtype">
                <option value="0">ุงูููุน ุงูุซุงูู ุฃู ุฃู ููุน ุขุฎุฑ (0)</option>
                <option value="1">ุงูููุน ุงูุฃูู ุฃู LADA (+1)</option>
              </select>
            </div>
            <div>
              <label for="ddur">ูุฏุฉ ุงูุฅุตุงุจุฉ ุจุงูุณููุงุช</label>
              <select id="ddur">
                <option value="0">ุฃูู ูู 10 ุณููุงุช (0)</option>
                <option value="0.5">ูู 10 ุฅูู 20 ุณูุฉ (+0.5)</option>
                <option value="1">ุฃูุซุฑ ูู 20 ุณูุฉ (+1)</option>
              </select>
            </div>
          </div>
        </details>

        <!-- 4) ุงูุนูุงุฌ -->
        <details>
          <summary>4) ููุน ุนูุงุฌ ุงูุณูุฑู <small>(ุงุฎุชุฑ ูู ูุง ููุทุจู)</small></summary>

          <div class="checks" id="txChecks">
            <label class="check"><input type="checkbox" data-score="2">
              <div><b>ุญูู ุฃูุณูููู ูุฎููุท ุนุฏุฉ ูุฑุงุช ูููููุง</b><span>(+2)</span></div>
            </label>

            <label class="check"><input type="checkbox" data-score="1.5">
              <div><b>ุฃูุณูููู ูุฎููุท ูุฑุฉ ูุงุญุฏุฉ ูููููุง</b><span>(+1.5)</span></div>
            </label>

            <label class="check"><input type="checkbox" data-score="1.5">
              <div><b>ูุถุฎุฉ ุฃูุณูููู (ุญููุฉ ููุชูุญุฉ)</b><span>(+1.5)</span></div>
            </label>

            <label class="check"><input type="checkbox" data-score="1">
              <div><b>ูุธุงู ุชูุตูู ุฃูุณูููู ุขูู (AID)</b><span>(+1)</span></div>
            </label>

            <label class="check"><input type="checkbox" data-score="1">
              <div><b>ุฃูุณูููู ูุงุนุฏู ููุงุณู (NPH/Detemir/Glargine 100)</b><span>(+1)</span></div>
            </label>

            <label class="check"><input type="checkbox" data-score="0.75">
              <div><b>ุฃูุณูููู ูุงุนุฏู ูุงุฆู/ุทููู ุฌุฏูุง (Glargine 300 ุฃู Degludec)</b><span>(+0.75)</span></div>
            </label>

            <label class="check"><input type="checkbox" data-score="0.75">
              <div><b>ุฃูุณูููู ูุตูุฑ/ุณุฑูุน ุงูููุนูู</b><span>(+0.75)</span></div>
            </label>

            <label class="check"><input type="checkbox" data-score="0.75">
              <div><b>ุบููุจููููุงููุฏ ุฃู ุบููุจูุฒูุฏ</b><span>(+0.75)</span></div>
            </label>

            <label class="check"><input type="checkbox" data-score="0.5">
              <div><b>ุณูููููู ููุฑูุง ุญุฏูุซุฉ ุฃู ุฑูุจุงูููููุฏ</b><span>(+0.5)</span></div>
            </label>

            <label class="check"><input type="checkbox" data-score="0.25">
              <div><b>ุฃูุซุฑ ูู ุฏูุงุฆูู ุฎุงูุถูู ููุณูุฑ (ุจุงุณุชุซูุงุก ุงูุฃูุณูููู/ุงูุณูููููู ููุฑูุง)</b><span>(+0.25)</span></div>
            </label>

            <label class="check"><input type="checkbox" data-score="0">
              <div><b>ุชุนุฏูู ููุท ุงูุญูุงุฉ ููุท ุฃู ุนูุงุฌ ุฃุญุงุฏู (ุบูุฑ ุฃูุณูููู/ุบูุฑ ุณูููููู ููุฑูุง)</b><span>(0)</span></div>
            </label>
          </div>

          <div class="note" style="margin-top:10px">
            ุงุฎุชุฑ ุงูุนูุงุฌ/ุงูุนูุงุฌุงุช ุงููุณุชุฎุฏูุฉ ุญุงูููุง. ุณูุชู ุฌูุน ููุงุท ุงูุฎูุงุฑุงุช ุงููุญุฏุฏุฉ (ููุง ูู ุฃุฏุงุฉ DAR).
          </div>
        </details>

        <!-- 5 + 6 + 7 -->
        <details>
          <summary>5) ุงูุฎูุงุถ ุงูุณูุฑ + 6) HbA1c + 7) ูุฑุงูุจุฉ ุงูุฌููููุฒ</summary>
          <div class="row">
            <div>
              <label for="hypo">ููุจุงุช ุงูุฎูุงุถ ุณูุฑ ุงูุฏู (ุขุฎุฑ 4 ุฃุณุงุจูุน)</label>
              <select id="hypo">
                <option value="0">ูุง ููุฌุฏ (0)</option>
                <option value="0.5">ุฃูู ูู ูุฑุฉ ุฃุณุจูุนููุง (+0.5)</option>
                <option value="1">1โ2 ููุจุฉ ุฃุณุจูุนููุง (+1)</option>
                <option value="2">3โ5 ููุจุงุช ุฃุณุจูุนููุง (+2)</option>
                <option value="3">6โ7 ููุจุงุช ุฃุณุจูุนููุง (+3)</option>
                <option value="4">ุฃูุซุฑ ูู ูุฑุฉ ูููููุง (+4)</option>
                <option value="5">ููุจุฉ ุดุฏูุฏุฉ ุฎูุงู ุขุฎุฑ 4 ุฃุณุงุจูุน (+5)</option>
                <option value="6.5">ุถุนู/ุงูุนุฏุงู ุงูุฅุญุณุงุณ ุจุงูุฎูุงุถ ุงูุณูุฑ (+6.5)</option>
              </select>
            </div>

            <div>
              <label for="a1c">HbA1c (ุขุฎุฑ ูุฑุงุกุฉ)</label>
              <select id="a1c">
                <option value="0">ุฃูู ูู 7.5% (0)</option>
                <option value="0.5">ูู 7.5% ุฅูู 9% (+0.5)</option>
                <option value="1">ุฃุนูู ูู 9% (+1)</option>
              </select>
            </div>
          </div>

          <label for="gmon" style="margin-top:10px">ูุฑุงูุจุฉ ุงูุฌููููุฒ</label>
          <select id="gmon">
            <option value="2">ูู ุชูุฌุฑู ุงููุฑุงูุจุฉ (+2)</option>
            <option value="1">ุฃูุฌุฑูุช ุจุดูู ุบูุฑ ูุซุงูู (+1)</option>
            <option value="0">ุฃูุฌุฑูุช ููุง ูู ููุตู (0)</option>
            <option value="-0.5">ุงุณุชุฎุฏุงู ุฌูุงุฒ ูุฑุงูุจุฉ ูุณุชูุฑุฉ CGM (-0.5)</option>
          </select>
        </details>

        <!-- 8 + 9 -->
        <details>
          <summary>8) ุทูุงุฑุฆ ูุฑุท ุงูุณูุฑ + 9) ูุถุงุนูุงุช ูุนุงุฆูุฉ ูุจุฑู</summary>
          <div class="row">
            <div>
              <label for="hyperE">DKA ุฃู HHS (ุขุฎุฑ 6 ุฃุดูุฑ)</label>
              <select id="hyperE">
                <option value="0">ูุง ููุฌุฏ (0)</option>
                <option value="1">ุฎูุงู 4โ6 ุฃุดูุฑ (+1)</option>
                <option value="2">ุฎูุงู 2โ3 ุฃุดูุฑ (+2)</option>
                <option value="3.5">ุฎูุงู ุงูุดูุฑ ุงููุงุถู (+3.5)</option>
              </select>
            </div>

            <div>
              <label for="macroV">ูุฑุถ ูุนุงุฆู ูุจูุฑ (ููุจ/ุณูุชุฉ/ุดุฑุงููู ุทุฑููุฉ)</label>
              <select id="macroV">
                <option value="0">ูุง ููุฌุฏ (0)</option>
                <option value="2">ููุฌูุฏ ููุณุชูุฑ (+2)</option>
                <option value="6.5">ุบูุฑ ูุณุชูุฑ/ุญุฏูุซ (+6.5)</option>
              </select>
            </div>
          </div>
        </details>

        <!-- 10 -->
        <details>
          <summary>10) ูุถุงุนูุงุช ูุนุงุฆูุฉ ุตุบุฑู</summary>
          <div class="row">
            <div>
              <label for="egfr">ุฃ) ูุธุงุฆู ุงูููู (eGFR)</label>
              <select id="egfr">
                <option value="0">ุฃูุจุฑ ูู 60 (0)</option>
                <option value="2">45 ุฅูู 60 (+2)</option>
                <option value="4">30 ุฅูู 45 (+4)</option>
                <option value="6.5">ุฃูู ูู 30 (+6.5)</option>
              </select>
            </div>

            <div>
              <label for="microC">ุจ) ุงุนุชูุงู ุงูุฃุนุตุงุจ/ุงููุฏู/ุงูุดุจููุฉ (ุนุฏุฏ ุงููุถุงุนูุงุช)</label>
              <select id="microC">
                <option value="0">ูุง ุชูุฌุฏ (0)</option>
                <option value="1">ูุถุงุนูุฉ ูุงุญุฏุฉ (+1)</option>
                <option value="2">ูุถุงุนูุชุงู (+2)</option>
                <option value="3">ุซูุงุซ ูุถุงุนูุงุช (+3)</option>
              </select>
            </div>
          </div>
        </details>

        <!-- 11 + 12 + 13 + 14 -->
        <details>
          <summary>11) ุงูุฅุฏุฑุงู/ุงููุดุงุดุฉ/ุงูุนูุฑ + 12) ุงูุนูู ุงูุจุฏูู + 13) ุงูุชุซููู + 14) ุณุงุนุงุช ุงูุตูุงู</summary>
          <div class="row">
            <div>
              <label for="cog">ุงูุฅุฏุฑุงู/ุงููุดุงุดุฉ/ุงูุนูุฑ</label>
              <select id="cog">
                <option value="0">ุทุจูุนู ููุง ุชูุฌุฏ ูุดุงุดุฉ (0)</option>
                <option value="1">ุงูุนูุฑ ุฃูุจุฑ ูู 70 ุณูุฉ ุฏูู ุฏุนู ููุฒูู (+1)</option>
                <option value="4">ูุดุงุดุฉ ุฎูููุฉ ุฅูู ูุชูุณุทุฉ (+4)</option>
                <option value="6.5">ูุดุงุดุฉ ูุชูุฏูุฉ (+6.5)</option>
                <option value="6.5">ุถุนู ุฅุฏุฑุงูู (+6.5)</option>
              </select>
            </div>

            <div>
              <label for="labor">ุงูุนูู ุงูุจุฏูู</label>
              <select id="labor">
                <option value="0">ุดุฏุฉ ููุฎูุถุฉ (0)</option>
                <option value="2">ุดุฏุฉ ูุชูุณุทุฉ (+2)</option>
                <option value="4">ุดุฏุฉ ุนุงููุฉ (+4)</option>
              </select>
            </div>
          </div>

          <div class="row">
            <div>
              <label for="edu">ุงูุชุซููู ุงูููุฌู ููุตูุงู</label>
              <select id="edu">
                <option value="0">ุชู ุชูุฏูู ุงูุชุซููู (0)</option>
                <option value="1">ูู ูุชู ุชูุฏูู ุงูุชุซููู (+1)</option>
              </select>
            </div>

            <div>
              <label for="fhours">ุนุฏุฏ ุณุงุนุงุช ุงูุตูุงู ุงููุชููุนุฉ</label>
              <select id="fhours">
                <option value="0">ุฃูู ูู 16 ุณุงุนุฉ (0)</option>
                <option value="1">16 ุณุงุนุฉ ุฃู ุฃูุซุฑ (+1)</option>
              </select>
            </div>
          </div>
        </details>

        <div class="actions">
          <button class="primary" type="button" onclick="calc()">ุงุญุณุจ ุงููุชูุฌุฉ</button>
          <button class="ghost" type="button" onclick="resetAll()">ุฅุนุงุฏุฉ ุชุนููู</button>
          <button class="secondary" type="button" onclick="window.print()">ุทุจุงุนุฉ</button>
        </div>
        <div class="printHint">ููุนูุงุฏุฉ: ูููู ุทุจุงุนุฉ ุงููุชูุฌุฉ ุฃู ุญูุธูุง PDF ูู ุดุงุดุฉ ุงูุทุจุงุนุฉ.</div>
      </div>

      <!-- ุงููุชุงุฆุฌ -->
      <div class="card">
        <h2>ุงููุชูุฌุฉ</h2>

        <div id="patientPrint" class="note" style="margin-top:10px; display:none;"></div>

        <div class="note">
          ุชูุณูุฑ ูุณุชูู ุงููุฎุงุทุฑ ููุง <b>ุฅุฑุดุงุฏู</b>. ุงููุฑุงุฑ ุงูููุงุฆู ููุตูุงู ูุฌุจ ุฃู ูููู ุจุนุฏ ุชูููู ุทุจู ูุฑุฏู ูุฎุทุฉ ุนูุงุฌ ููุงุณุจุฉ.
        </div>

        <div id="res" class="resultBox" style="margin-top:12px;">
          <p class="bigScore">โ</p>
          <p class="small">ุงุถุบุท โุงุญุณุจ ุงููุชูุฌุฉโ ูุนุฑุถ ูุฌููุน ุงูููุงุท.</p>
        </div>

        <div id="detailArea" style="margin-top:12px; display:none;">
          <h3 style="margin:0 0 8px; font-size:1.05rem;">ุชูุงุตูู ุงูููุงุท</h3>
          <table>
            <thead><tr><th>ุงูุจูุฏ</th><th>ุงูููุงุท</th></tr></thead>
            <tbody id="detailsTbody"></tbody>
          </table>
        </div>

        <div class="qrArea">
          <div>
            <h3 style="margin:0 0 6px; font-size:1.05rem;">ุงููุตูู ุงูุณุฑูุน ููุฃุฏุงุฉ</h3>
            <div class="note" style="margin:0">
              <div>ุงูุฑุงุจุท ุงููุจุงุดุฑ:</div>
              <div style="margin-top:6px; font-weight:700;">
                <a id="directLink" href="#" target="_blank" rel="noopener"></a>
              </div>
            </div>
          </div>
          <img class="qr" id="qrImg" alt="QR Code" />
        </div>

        <div class="card" style="margin-top:12px; border:1px solid var(--border); background:#fff;">
          <h3 style="margin:0 0 8px; font-size:1.05rem;">ุฏุนุงุก ุฑูุถุงู</h3>
          <div class="note" style="margin:0; font-size:1rem; color:#2b3a4a;">
            ุงูููู ุจูุบูุง ุฑูุถุงู ููุนุงูููุ ููุจููููุ ูุทูุฆูููุ ูุฌุจูุฑูู ุงูุฎุงุทุฑุ ูู ุธูุงู ุฑุญูุชู ูุนููู.
          </div>
        </div>

        <footer>
          ุดูุฑูุง ููู ๐<br/>
          ุนูู ูุชูุณูู ุงูุฃุฎุตุงุฆูุฉ: <strong>ุชูุงุฑุง ุนุจุฏุงูุฑุญูู ุญุงูุธ</strong><br/>
          ูุฏุฑุจุฉ ููุซููุฉ ูุฑุถู ุงูุณูุฑู
        </footer>
      </div>
    </div>
  </div>

<script>
  // ุถุน ุฑุงุจุท GitHub Pages ุงูุฎุงุต ุจู ููุง (ููุณ ุฑุงุจุทู ุงูุญุงูู)
  const TOOL_URL = "https://tamara15951.github.io/ramadan-diabetes-risk/";

  function setQR(){
    const qr = document.getElementById("qrImg");
    const link = document.getElementById("directLink");
    link.href = TOOL_URL;
    link.textContent = TOOL_URL;
    qr.src = "https://api.qrserver.com/v1/create-qr-code/?size=180x180&data=" + encodeURIComponent(TOOL_URL);
  }

  function setToday(){
    const el = document.getElementById("pdate");
    const d = new Date();
    const yyyy = d.getFullYear();
    const mm = String(d.getMonth()+1).padStart(2,"0");
    const dd = String(d.getDate()).padStart(2,"0");
    el.value = `${yyyy}-${mm}-${dd}`;
  }

  function escapeHtml(str){
    return String(str)
      .replaceAll("&","&amp;")
      .replaceAll("<","&lt;")
      .replaceAll(">","&gt;")
      .replaceAll("\"","&quot;")
      .replaceAll("'","&#039;");
  }

  function sumTreatmentScores(){
    let total = 0;
    document.querySelectorAll("#txChecks input[type='checkbox']").forEach(ch => {
      if(ch.checked) total += parseFloat(ch.dataset.score);
    });
    return total;
  }

  function fmt(n){ return (Math.round(n * 100) / 100).toString(); }

  function calc(){
    const parts = [];

    const preg  = parseFloat(document.getElementById("preg").value);   parts.push(["ุงูุญูู", preg]);
    const dtype = parseFloat(document.getElementById("dtype").value);  parts.push(["ููุน ุงูุณูุฑู", dtype]);
    const ddur  = parseFloat(document.getElementById("ddur").value);   parts.push(["ูุฏุฉ ุงูุฅุตุงุจุฉ", ddur]);

    const tx = sumTreatmentScores();                                   parts.push(["ููุน ุงูุนูุงุฌ (ูุฌููุน ุงูุฎูุงุฑุงุช)", tx]);

    const hypo = parseFloat(document.getElementById("hypo").value);    parts.push(["ุงูุฎูุงุถ ุงูุณูุฑ", hypo]);
    const a1c  = parseFloat(document.getElementById("a1c").value);     parts.push(["HbA1c", a1c]);
    const gmon = parseFloat(document.getElementById("gmon").value);    parts.push(["ูุฑุงูุจุฉ ุงูุฌููููุฒ", gmon]);

    const hyperE = parseFloat(document.getElementById("hyperE").value);parts.push(["ุทูุงุฑุฆ ูุฑุท ุงูุณูุฑ (DKA/HHS)", hyperE]);
    const macroV = parseFloat(document.getElementById("macroV").value);parts.push(["ูุถุงุนูุงุช ูุนุงุฆูุฉ ูุจุฑู", macroV]);

    const egfr  = parseFloat(document.getElementById("egfr").value);   parts.push(["ูุธุงุฆู ุงูููู (eGFR)", egfr]);
    const microC= parseFloat(document.getElementById("microC").value); parts.push(["ูุถุงุนูุงุช ูุนุงุฆูุฉ ุตุบุฑู ุฃุฎุฑู", microC]);

    const cog   = parseFloat(document.getElementById("cog").value);    parts.push(["ุงูุฅุฏุฑุงู/ุงููุดุงุดุฉ/ุงูุนูุฑ", cog]);
    const labor = parseFloat(document.getElementById("labor").value);  parts.push(["ุงูุนูู ุงูุจุฏูู", labor]);
    const edu   = parseFloat(document.getElementById("edu").value);    parts.push(["ุงูุชุซููู ุงูููุฌู ููุตูุงู", edu]);
    const fhours= parseFloat(document.getElementById("fhours").value); parts.push(["ุณุงุนุงุช ุงูุตูุงู", fhours]);

    const total = parts.reduce((acc, p) => acc + p[1], 0);

    // ุชุตููู ุฅุฑุดุงุฏู ุดุงุฆุน: ููุฎูุถ โค3 | ูุชูุณุท >3 ุฅูู 6 | ูุฑุชูุน >6
    let level="", cls="", guidance="";
    if(total <= 3){
      level="ูุฎุงุทุฑ ููุฎูุถุฉ";
      cls="low";
      guidance="ุบุงูุจูุง ูููู ุงูุตูุงู ูุน ุงูุงูุชุฒุงู ุจุฅุฑุดุงุฏุงุช ุงูุทุจูุจ ูุฎุทุฉ ุงููุฑุงูุจุฉ ูุชุนุฏูู ุงูุนูุงุฌ ุนูุฏ ุงูุญุงุฌุฉ.";
    }else if(total <= 6){
      level="ูุฎุงุทุฑ ูุชูุณุทุฉ";
      cls="med";
      guidance="ูููู ุงูุตูุงู ุจุญุฐุฑ ูุน ูุชุงุจุนุฉ ูุตููุฉ ูุชุนุฏูู ุนูุงุฌู ูุงุถุญ ูุฎุทุฉ ููุงุณ ุณูุฑ ููุชุธูุฉ.";
    }else{
      level="ูุฎุงุทุฑ ูุฑุชูุนุฉ";
      cls="high";
      guidance="ูุฏ ูุง ูููู ุงูุตูุงู ุขูููุง. ูููุตุญ ุจููุงูุดุฉ ุงูุจุฏุงุฆู ูุงูุฑุฎุต ุงูุดุฑุนูุฉ ูุน ุงูุทุจูุจ ุญูุงุธูุง ุนูู ุงูุตุญุฉ.";
    }

    // ุนุฑุถ ุจูุงูุงุช ุงููุฑูุถ (ุฅู ููุฌุฏุช)
    const pname = (document.getElementById("pname").value || "").trim();
    const page  = (document.getElementById("page").value || "").toString().trim();
    const psex  = document.getElementById("psex").value;
    const pdate = document.getElementById("pdate").value;

    const pLines = [];
    if (pname) pLines.push(`<b>ุงุณู ุงููุฑูุถ:</b> ${escapeHtml(pname)}`);
    if (page)  pLines.push(`<b>ุงูุนูุฑ:</b> ${escapeHtml(page)} ุณูุฉ`);
    if (psex)  pLines.push(`<b>ุงูุฌูุณ:</b> ${escapeHtml(psex)}`);
    if (pdate) pLines.push(`<b>ุชุงุฑูุฎ ุงูุชูููู:</b> ${escapeHtml(pdate)}`);

    const patientBox = document.getElementById("patientPrint");
    if (pLines.length){
      patientBox.innerHTML = pLines.join(" &nbsp; | &nbsp; ");
      patientBox.style.display = "block";
    }else{
      patientBox.style.display = "none";
    }

    // ุงููุชูุฌุฉ
    const res = document.getElementById("res");
    res.className = "resultBox " + cls;
    res.innerHTML = `
      <p class="bigScore">${fmt(total)} ููุทุฉ</p>
      <p class="small"><b>${level}</b> โ ${guidance}</p>
      <p class="small" style="margin-top:8px;">
        ุชูุจูู: ูุฐู ุงููุชูุฌุฉ ุชุซููููุฉ ููุง ุชูุนุฏ ูุชูู ุฃู ูุฑุงุฑูุง ุทุจููุง ููุงุฆููุง.
      </p>
    `;

    // ุชูุงุตูู ุงูููุงุท
    const tbody = document.getElementById("detailsTbody");
    tbody.innerHTML = "";
    parts.forEach(([name, score]) => {
      const tr = document.createElement("tr");
      tr.innerHTML = `<td>${name}</td><td>${fmt(score)}</td>`;
      tbody.appendChild(tr);
    });

    document.getElementById("detailArea").style.display = "block";
    window.scrollTo({top:0, behavior:"smooth"});
  }

  function resetAll(){
    // ุฅุนุงุฏุฉ ุงูููุงุฆู
    ["preg","dtype","ddur","hypo","a1c","gmon","hyperE","macroV","egfr","microC","cog","labor","edu","fhours"]
      .forEach(id => document.getElementById(id).selectedIndex = 0);

    // ุฅูุบุงุก ุงูุงุฎุชูุงุฑุงุช ูู ุงูุนูุงุฌ
    document.querySelectorAll("#txChecks input[type='checkbox']").forEach(ch => ch.checked = false);

    // ุชูุฑูุบ ุจูุงูุงุช ุงููุฑูุถ
    document.getElementById("pname").value = "";
    document.getElementById("page").value = "";
    document.getElementById("psex").selectedIndex = 0;
    setToday();
    document.getElementById("patientPrint").style.display = "none";

    // ุฅุนุงุฏุฉ ุงููุชูุฌุฉ
    const res = document.getElementById("res");
    res.className = "resultBox";
    res.innerHTML = `<p class="bigScore">โ</p><p class="small">ุงุถุบุท โุงุญุณุจ ุงููุชูุฌุฉโ ูุนุฑุถ ูุฌููุน ุงูููุงุท.</p>`;
    document.getElementById("detailArea").style.display = "none";
  }

  setQR();
  setToday();
</script>
</body>
</html>
